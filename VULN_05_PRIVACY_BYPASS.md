# –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å: –û–±—Ö—ñ–¥ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—ñ –≤ –ø–æ—à—É–∫—É (VULN_05)

## üìù –û–ø–∏—Å
–£ —Å–µ—Ä–≤—ñ—Å—ñ `src/lib/firebase/FriendsService.ts` –º–µ—Ç–æ–¥ `searchUsers` –≤–∏–∫–æ–Ω—É—î –ø–æ—à—É–∫ –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ –∑–∞ —ñ–º–µ–Ω–µ–º –∞–±–æ email, –∞–ª–µ –ø–æ–≤–Ω—ñ—Å—Ç—é —ñ–≥–Ω–æ—Ä—É—î –ø–æ–ª–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—ñ `privacy.showInSearch`.

```typescript
// –ü–æ—Ç–æ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è (—Ñ—Ä–∞–≥–º–µ–Ω—Ç)
const emailQuery = query(
    profilesRef,
    where("searchableEmail", "==", queryLower),
    limit(maxResults),
);
```

## üî¥ –†–∏–∑–∏–∫–∏
1. **–ü–æ—Ä—É—à–µ–Ω–Ω—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—ñ:** –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, —è–∫—ñ —è–≤–Ω–æ –≤–∏–º–∫–Ω—É–ª–∏ –æ–ø—Ü—ñ—é "–ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ –º–µ–Ω–µ –≤ –ø–æ—à—É–∫—É", –≤—Å–µ –æ–¥–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö.
2. **Scraping –¥–∞–Ω–∏—Ö:** –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –∑–±–∏—Ä–∞—Ç–∏ –±–∞–∑—É email-–∞–¥—Ä–µ—Å —Ç–∞ —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–æ–¥–∞—Ç–∫—É, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–±–∏—Ä–∞—é—á–∏ –ø—Ä–µ—Ñ—ñ–∫—Å–∏ —ñ–º–µ–Ω.
3. **–ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å GDPR:** –ù–µ–¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —â–æ–¥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—ñ –π–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

## üõ† –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
1. **Firestore Filter:** –î–æ–¥–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—É —É–º–æ–≤—É `.where("privacy.showInSearch", "==", true)` –¥–æ –≤—Å—ñ—Ö –ø–æ—à—É–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ —É `searchUsers`.
2. **Security Rules:** –ü–æ—Å–∏–ª–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ Firestore, —â–æ–± –∑–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—ñ–≤, –¥–µ `showInSearch` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ `false`, —è–∫—â–æ —Ü–µ –Ω–µ –≤–ª–∞—Å–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å.

---

## ‚úÖ –°—Ç–∞—Ç—É—Å: –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ (05.02.2026)
1. –£ –º–µ—Ç–æ–¥ `searchUsers` –¥–æ–¥–∞–Ω–æ –æ–±–æ–≤'—è–∑–∫–æ–≤—É —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é `where("privacy.showInSearch", "==", true)`. –¢–µ–ø–µ—Ä –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–Ω–∞–π—Ç–∏ –Ω—ñ –∑–∞ email, –Ω—ñ –∑–∞ —ñ–º–µ–Ω–µ–º.
2. –ú–µ—Ç–æ–¥ `updatePublicProfile` –æ–Ω–æ–≤–ª–µ–Ω–æ —Ç–∞–∫–∏–º —á–∏–Ω–æ–º, —â–æ –≤—ñ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î –æ–±'—î–∫—Ç `privacy` –∑ –¥–æ–∑–≤–æ–ª–æ–º –Ω–∞ –ø–æ—à—É–∫ (`true`) –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–ª—è –Ω–æ–≤–∏—Ö —Ç–∞ —ñ—Å–Ω—É—é—á–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ —â–µ –Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ñ—Å—Ç—å. –¶–µ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –∞–∫—Ç–∏–≤–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –Ω–µ –∑–Ω–∏–∫–Ω—É—Ç—å –∑ –ø–æ—à—É–∫—É –ø—ñ—Å–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó.

